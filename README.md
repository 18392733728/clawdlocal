# ClawdLocal - æœ¬åœ°AIä»£ç†æ¡†æ¶

## é¡¹ç›®çŠ¶æ€

âœ… **å·²å®Œæˆ**:
- æ ¸å¿ƒäº‹ä»¶å¾ªç¯ç³»ç»Ÿ (Event Loop)
- æ¶ˆæ¯å¤„ç†ç³»ç»Ÿ (Message Handler & Router)  
- åŸºç¡€é…ç½®ç³»ç»Ÿ
- é”™è¯¯å¤„ç†æœºåˆ¶
- ç¤ºä¾‹å¤„ç†å™¨å®ç°
- å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹
- **å·¥å…·è°ƒç”¨ç³»ç»Ÿ** (Tool Calling System)
- **è®°å¿†ç³»ç»Ÿ** (Memory System) - æ”¯æŒçŸ­æœŸå’Œé•¿æœŸè®°å¿†
- **Webç•Œé¢** (Web Interface) - æä¾›å¯è§†åŒ–ç›‘æ§å’Œäº¤äº’

ğŸ”„ **è¿›è¡Œä¸­**:
- æ€§èƒ½ä¼˜åŒ–å’Œç›‘æ§
- æ’ä»¶ç³»ç»Ÿ

## æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Events    â”‚â”€â”€â”€â–¶â”‚ Event Loop  â”‚â”€â”€â”€â–¶â”‚  Handlers   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â–²                                   â”‚
       â”‚                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Messages  â”‚â”€â”€â”€â–¶â”‚ Message     â”‚â”€â”€â”€â–¶â”‚ Message     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Router      â”‚    â”‚ Handlers    â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ Web Server  â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒç‰¹æ€§

### 1. äº‹ä»¶å¾ªç¯ (Event Loop)
- æ”¯æŒå¤šç§äº‹ä»¶ç±»å‹: message, tool_call, system, heartbeat, cron
- å¯é…ç½®çš„é˜Ÿåˆ—å¤§å°å’Œå¹¶å‘å¤„ç†
- ä¼˜é›…çš„å¯åŠ¨/åœæ­¢æœºåˆ¶
- ä¸Šä¸‹æ–‡å–æ¶ˆæ”¯æŒ

### 2. æ¶ˆæ¯å¤„ç† (Message Handling)
- çµæ´»çš„æ¶ˆæ¯è·¯ç”±ç³»ç»Ÿ
- å¤šå¤„ç†å™¨æ”¯æŒï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åº
- å†…ç½®æ¶ˆæ¯é˜Ÿåˆ—
- ç±»å‹å®‰å…¨çš„æ¶ˆæ¯ç»“æ„

### 3. å·¥å…·è°ƒç”¨ç³»ç»Ÿ (Tool Calling)
- åŠ¨æ€å·¥å…·æ³¨å†Œå’Œç®¡ç†
- åŒæ­¥/å¼‚æ­¥å·¥å…·æ‰§è¡Œ
- å‚æ•°éªŒè¯å’Œé”™è¯¯å¤„ç†
- å¯é…ç½®çš„è¶…æ—¶å’Œé‡è¯•ç­–ç•¥

### 4. è®°å¿†ç³»ç»Ÿ (Memory System)
- **çŸ­æœŸè®°å¿†**: åŸºäºæ—¶é—´çª—å£çš„æœ€è¿‘äº‹ä»¶ç¼“å­˜
- **é•¿æœŸè®°å¿†**: æŒä¹…åŒ–å­˜å‚¨çš„é‡è¦ä¿¡æ¯
- è‡ªåŠ¨è®°å¿†æ¸…ç†å’Œè¿‡æœŸæœºåˆ¶
- æ”¯æŒè®°å¿†æŸ¥è¯¢å’Œæ£€ç´¢

### 5. Webç•Œé¢ (Web Interface)
- å®æ—¶ç³»ç»ŸçŠ¶æ€ç›‘æ§
- äº‹ä»¶æµå¯è§†åŒ–
- è®°å¿†æ•°æ®æŸ¥çœ‹å’Œç®¡ç†
- äº¤äº’å¼æµ‹è¯•æ§åˆ¶å°
- å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡

### 6. é…ç½®ç®¡ç†
- YAMLé…ç½®æ–‡ä»¶æ”¯æŒ
- ç¯å¢ƒå˜é‡è¦†ç›–
- é»˜è®¤é…ç½®å›é€€
- æ¨¡å—åŒ–é…ç½®ï¼ˆäº‹ä»¶å¾ªç¯ã€å·¥å…·ã€è®°å¿†ã€Webç­‰ï¼‰

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
# éœ€è¦Go 1.19+
go mod tidy
```

### 2. è¿è¡Œç¤ºä¾‹
```bash
# ä½¿ç”¨é»˜è®¤é…ç½®ï¼ˆåŒ…å«æ‰€æœ‰åŠŸèƒ½ï¼‰
go run main.go

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®
go run main.go config/event_loop.yaml

# å¯ç”¨Webç•Œé¢
# é»˜è®¤é…ç½®å·²åŒ…å«WebæœåŠ¡å™¨ï¼Œè®¿é—® http://localhost:8080
```

### 3. åˆ›å»ºè‡ªå®šä¹‰å¤„ç†å™¨
```go
type MyHandler struct{}

func (h *MyHandler) Handle(ctx context.Context, event *core.Event) error {
    // å¤„ç†äº‹ä»¶é€»è¾‘
    return nil
}

func (h *MyHandler) CanHandle(eventType core.EventType) bool {
    return eventType == core.EventTypeMessage
}
```

### 4. æ³¨å†Œè‡ªå®šä¹‰å·¥å…·
```go
// åœ¨Agentåˆå§‹åŒ–åæ³¨å†Œå·¥å…·
agent.RegisterTool("my_tool", &MyCustomTool{})

// å·¥å…·å®ç°éœ€è¦å®ç°core.Toolæ¥å£
type MyCustomTool struct{}

func (t *MyCustomTool) Name() string { return "my_tool" }
func (t *MyCustomTool) Description() string { return "My custom tool description" }
func (t *MyCustomTool) Execute(ctx context.Context, params map[string]interface{}) (interface{}, error) {
    // å·¥å…·æ‰§è¡Œé€»è¾‘
    return "result", nil
}
```

### 5. ä½¿ç”¨è®°å¿†ç³»ç»Ÿ
```go
// å­˜å‚¨åˆ°çŸ­æœŸè®°å¿†
agent.Memory().StoreShortTerm("user_preference", "dark_mode")

// å­˜å‚¨åˆ°é•¿æœŸè®°å¿†
agent.Memory().StoreLongTerm("user_profile", userProfileData)

// æŸ¥è¯¢è®°å¿†
value, found := agent.Memory().Get("user_preference")
```

## é…ç½®é€‰é¡¹

æŸ¥çœ‹ä»¥ä¸‹é…ç½®æ–‡ä»¶äº†è§£å¯ç”¨çš„é…ç½®é€‰é¡¹ï¼š
- `config/default.yaml` - åŸºç¡€é…ç½®
- `config/event_loop.yaml` - äº‹ä»¶å¾ªç¯é…ç½®
- `config/tools.yaml` - å·¥å…·è°ƒç”¨é…ç½®  
- `config/memory.yaml` - è®°å¿†ç³»ç»Ÿé…ç½®
- `config/web.yaml` - Webç•Œé¢é…ç½®

## Webç•Œé¢åŠŸèƒ½

å¯åŠ¨åº”ç”¨åï¼Œè®¿é—® `http://localhost:8080` å¯ä»¥ä½¿ç”¨Webç•Œé¢ï¼š

- **ç³»ç»ŸçŠ¶æ€**: æŸ¥çœ‹Agentè¿è¡ŒçŠ¶æ€ã€äº‹ä»¶é˜Ÿåˆ—é•¿åº¦ç­‰
- **äº‹ä»¶ç›‘æ§**: å®æ—¶æ˜¾ç¤ºå¤„ç†çš„äº‹ä»¶æµ
- **è®°å¿†ç®¡ç†**: æŸ¥çœ‹å’Œç®¡ç†çŸ­æœŸ/é•¿æœŸè®°å¿†æ•°æ®
- **äº¤äº’æµ‹è¯•**: ç›´æ¥åœ¨æµè§ˆå™¨ä¸­å‘é€æ¶ˆæ¯æµ‹è¯•Agentå“åº”

## æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
go test ./core/...

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
go test ./core/ -run TestEventLoop
```

## ä¸‹ä¸€æ­¥å¼€å‘

1. **æ€§èƒ½ä¼˜åŒ–**: äº‹ä»¶å¤„ç†æ€§èƒ½åˆ†æå’Œä¼˜åŒ–
2. **æ’ä»¶ç³»ç»Ÿ**: æ”¯æŒåŠ¨æ€åŠ è½½å’Œå¸è½½åŠŸèƒ½æ¨¡å—
3. **æ›´å¤šå†…ç½®å·¥å…·**: æ–‡ä»¶æ“ä½œã€ç½‘ç»œè¯·æ±‚ã€æ•°æ®åº“è®¿é—®ç­‰
4. **é«˜çº§è®°å¿†åŠŸèƒ½**: è¯­ä¹‰æœç´¢ã€è®°å¿†å…³è”ç­‰

## è´¡çŒ®

æ¬¢è¿æäº¤PRï¼è¯·ç¡®ä¿:
- ä»£ç æ ¼å¼åŒ– (`go fmt`)
- æ·»åŠ ç›¸åº”çš„æµ‹è¯•
- æ›´æ–°æ–‡æ¡£
- æ¯å®Œæˆä¸€ä¸ªåŠŸèƒ½æ¨¡å—å°±æ¨é€ä¸€æ¬¡åˆ°GitHub