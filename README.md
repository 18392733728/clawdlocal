# ClawdLocal - æœ¬åœ°AIä»£ç†æ¡†æ¶

## é¡¹ç›®çŠ¶æ€

âœ… **å·²å®Œæˆ**:
- æ ¸å¿ƒäº‹ä»¶å¾ªç¯ç³»ç»Ÿ (Event Loop)
- æ¶ˆæ¯å¤„ç†ç³»ç»Ÿ (Message Handler & Router)  
- åŸºç¡€é…ç½®ç³»ç»Ÿ
- é”™è¯¯å¤„ç†æœºåˆ¶
- ç¤ºä¾‹å¤„ç†å™¨å®ç°
- å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹
- å·¥å…·è°ƒç”¨ç³»ç»Ÿ (Tool Calling System)

ğŸ”„ **è¿›è¡Œä¸­**:
- Agentä¸äº‹ä»¶å¾ªç¯çš„å®Œæ•´é›†æˆ
- æ›´å¤šå¤„ç†å™¨ç±»å‹çš„å®ç°
- æ€§èƒ½ä¼˜åŒ–å’Œç›‘æ§
- è®°å¿†ç³»ç»Ÿé›†æˆ

## æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Events    â”‚â”€â”€â”€â–¶â”‚ Event Loop  â”‚â”€â”€â”€â–¶â”‚  Handlers   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â–²                                   â”‚
       â”‚                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Messages  â”‚â”€â”€â”€â–¶â”‚ Message     â”‚â”€â”€â”€â–¶â”‚ Message     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Router      â”‚    â”‚ Handlers    â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒç‰¹æ€§

### 1. äº‹ä»¶å¾ªç¯ (Event Loop)
- æ”¯æŒå¤šç§äº‹ä»¶ç±»å‹: message, tool_call, system, heartbeat, cron
- å¯é…ç½®çš„é˜Ÿåˆ—å¤§å°å’Œå¹¶å‘å¤„ç†
- ä¼˜é›…çš„å¯åŠ¨/åœæ­¢æœºåˆ¶
- ä¸Šä¸‹æ–‡å–æ¶ˆæ”¯æŒ

### 2. æ¶ˆæ¯å¤„ç† (Message Handling)
- çµæ´»çš„æ¶ˆæ¯è·¯ç”±ç³»ç»Ÿ
- å¤šå¤„ç†å™¨æ”¯æŒï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åº
- å†…ç½®æ¶ˆæ¯é˜Ÿåˆ—
- ç±»å‹å®‰å…¨çš„æ¶ˆæ¯ç»“æ„

### 3. é…ç½®ç®¡ç†
- YAMLé…ç½®æ–‡ä»¶æ”¯æŒ
- ç¯å¢ƒå˜é‡è¦†ç›–
- é»˜è®¤é…ç½®å›é€€

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
# éœ€è¦Go 1.19+
go mod tidy
```

### 2. è¿è¡Œç¤ºä¾‹
```bash
# ä½¿ç”¨é»˜è®¤é…ç½®
go run main.go

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®
go run main.go config/event_loop.yaml
```

### 3. åˆ›å»ºè‡ªå®šä¹‰å¤„ç†å™¨
```go
type MyHandler struct{}

func (h *MyHandler) Handle(ctx context.Context, event *core.Event) error {
    // å¤„ç†äº‹ä»¶é€»è¾‘
    return nil
}

func (h *MyHandler) CanHandle(eventType core.EventType) bool {
    return eventType == core.EventTypeMessage
}
```

## é…ç½®é€‰é¡¹

æŸ¥çœ‹ `config/default.yaml` å’Œ `config/event_loop.yaml` äº†è§£å¯ç”¨çš„é…ç½®é€‰é¡¹ã€‚

## æµ‹è¯•

```bash
go test ./core/...
```

## ä¸‹ä¸€æ­¥å¼€å‘

1. **å·¥å…·è°ƒç”¨ç³»ç»Ÿ**: âœ… å®ç°å®Œæ•´çš„å·¥å…·æ³¨å†Œå’Œæ‰§è¡Œæ¡†æ¶
2. **è®°å¿†ç³»ç»Ÿ**: âœ… é›†æˆé•¿æœŸå’ŒçŸ­æœŸè®°å¿†å­˜å‚¨  
3. **å¤šAgentæ”¯æŒ**: âŒ ä¸éœ€è¦å®ç°
4. **Webç•Œé¢**: ğŸ”„ æä¾›å¯è§†åŒ–ç›‘æ§å’Œäº¤äº’ç•Œé¢
5. **æ’ä»¶ç³»ç»Ÿ**: æ”¯æŒåŠ¨æ€åŠ è½½å’Œå¸è½½åŠŸèƒ½æ¨¡å—

## è´¡çŒ®

æ¬¢è¿æäº¤PRï¼è¯·ç¡®ä¿:
- ä»£ç æ ¼å¼åŒ– (`go fmt`)
- æ·»åŠ ç›¸åº”çš„æµ‹è¯•
- æ›´æ–°æ–‡æ¡£